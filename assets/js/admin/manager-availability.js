webpackJsonp([5],{

/***/ 29:
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(30);


/***/ }),

/***/ 30:
/***/ (function(module, exports) {

var $ = window.jQuery;
var AweBooking = window.TheAweBooking;

$(function () {

  var $dialog = AweBooking.Popup.setup('#awebooking-set-availability-popup');

  var showComments = function showComments(calendar) {
    var nights = calendar.getNights();
    var toNight = calendar.endDay;

    var text = '';
    if (nights === 1) {
      text = 'One night: ' + toNight.format(calendar.format);
    } else {
      text = '<b>' + nights + '</b> nights' + ' nights, from <b>' + calendar.startDay.format(calendar.format) + '</b> to <b>' + toNight.format(calendar.format) + '</b>';
    }

    return text;
  };

  var onApplyCalendar = function onApplyCalendar() {
    var calendar = this;

    calendar.room_name = this.$el.closest('.abkngcal-container').find('h2').text();
    calendar.data_id = this.$el.closest('[data-room]').data('room');
    calendar.comments = showComments(calendar);

    var formTemplate = wp.template('availability-calendar-form');
    $dialog.find('.awebooking-dialog-contents').html(formTemplate(calendar));

    $dialog.find('form').data('calendar', calendar);
    $dialog.dialog('open');
  };

  var ajaxGetCalendar = function ajaxGetCalendar(calendar) {
    var $container = calendar.$el.parents('.abkngcal-container');
    $container.find('.abkngcal-ajax-loading').show();

    wp.ajax.post('get_awebooking_yearly_calendar', {
      year: $container.find('.abkngcal select').val(),
      room: $container.data('room')
    }).done(function (data) {
      calendar.destroy();
      calendar.$el.find('select').off();

      $container.html($(data.html).html());
      calendar.$el = $container.find('.abkngcal.abkngcal--yearly');

      calendar.initialize();
      calendar.on('apply', onApplyCalendar);
      calendar.$el.find('select').on('change', ajaxGetCalendar.bind(null, calendar));
    });
  };

  $('.abkngcal.abkngcal--yearly', document).each(function (index, el) {
    var calendar = new window.AweBookingYearlyCalendar(el);
    $(el).data('availability-calendar', calendar);

    calendar.on('apply', onApplyCalendar);
    calendar.$el.find('select').on('change', ajaxGetCalendar.bind(null, calendar));
  });

  $dialog.find('form').on('submit', function (e) {
    e.preventDefault();

    var $el = $(this);
    var calendar = $el.data('calendar');

    $el.addClass('ajax-loading');
    AweBooking.ajaxSubmit(this, 'set_awebooking_availability').always(function () {
      $el.removeClass('ajax-loading');
    }).done(function (data) {
      ajaxGetCalendar(calendar);
      $dialog.dialog('close');
    }).fail(function (e) {
      if (e.error && typeof e.error === 'string') {
        alert(e.error);
      }
    });
  });

  new AweBooking.RangeDatepicker('input[name="datepicker-start"]', 'input[name="datepicker-end"]').init();

  new AweBooking.ToggleCheckboxes('table.awebooking_page_manager-awebooking');
});

/***/ })

},[29]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hc3NldHMvanNzcmMvYWRtaW4vbWFuYWdlci1hdmFpbGFiaWxpdHkuanMiXSwibmFtZXMiOlsiJCIsIndpbmRvdyIsImpRdWVyeSIsIkF3ZUJvb2tpbmciLCJUaGVBd2VCb29raW5nIiwiJGRpYWxvZyIsIlBvcHVwIiwic2V0dXAiLCJzaG93Q29tbWVudHMiLCJjYWxlbmRhciIsIm5pZ2h0cyIsImdldE5pZ2h0cyIsInRvTmlnaHQiLCJlbmREYXkiLCJ0ZXh0IiwiZm9ybWF0Iiwic3RhcnREYXkiLCJvbkFwcGx5Q2FsZW5kYXIiLCJyb29tX25hbWUiLCIkZWwiLCJjbG9zZXN0IiwiZmluZCIsImRhdGFfaWQiLCJkYXRhIiwiY29tbWVudHMiLCJmb3JtVGVtcGxhdGUiLCJ3cCIsInRlbXBsYXRlIiwiaHRtbCIsImRpYWxvZyIsImFqYXhHZXRDYWxlbmRhciIsIiRjb250YWluZXIiLCJwYXJlbnRzIiwic2hvdyIsImFqYXgiLCJwb3N0IiwieWVhciIsInZhbCIsInJvb20iLCJkb25lIiwiZGVzdHJveSIsIm9mZiIsImluaXRpYWxpemUiLCJvbiIsImJpbmQiLCJkb2N1bWVudCIsImVhY2giLCJpbmRleCIsImVsIiwiQXdlQm9va2luZ1llYXJseUNhbGVuZGFyIiwiZSIsInByZXZlbnREZWZhdWx0IiwiYWRkQ2xhc3MiLCJhamF4U3VibWl0IiwiYWx3YXlzIiwicmVtb3ZlQ2xhc3MiLCJmYWlsIiwiZXJyb3IiLCJhbGVydCIsIlJhbmdlRGF0ZXBpY2tlciIsImluaXQiLCJUb2dnbGVDaGVja2JveGVzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQUEsSUFBTUEsSUFBSUMsT0FBT0MsTUFBakI7QUFDQSxJQUFNQyxhQUFhRixPQUFPRyxhQUExQjs7QUFFQUosRUFBRSxZQUFXOztBQUVYLE1BQU1LLFVBQVVGLFdBQVdHLEtBQVgsQ0FBaUJDLEtBQWpCLENBQXVCLG9DQUF2QixDQUFoQjs7QUFFQSxNQUFNQyxlQUFlLFNBQWZBLFlB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aWxhYmlsaXR5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgJCA9IHdpbmRvdy5qUXVlcnk7XHJcbmNvbnN0IEF3ZUJvb2tpbmcgPSB3aW5kb3cuVGhlQXdlQm9va2luZztcclxuXHJcbiQoZnVuY3Rpb24oKSB7XHJcblxyXG4gIGNvbnN0ICRkaWFsb2cgPSBBd2VCb29raW5nLlBvcHVwLnNldHVwKCcjYXdlYm9va2luZy1zZXQtYXZhaWxhYmlsaXR5LXBvcHVwJyk7XHJcblxyXG4gIGNvbnN0IHNob3dDb21tZW50cyA9IGZ1bmN0aW9uKGNhbGVuZGFyKSB7XHJcbiAgICBjb25zdCBuaWdodHMgPSBjYWxlbmRhci5nZXROaWdodHMoKTtcclxuICAgIGNvbnN0IHRvTmlnaHQgPSBjYWxlbmRhci5lbmREYXk7XHJcblxyXG4gICAgbGV0IHRleHQgPSAnJztcclxuICAgIGlmIChuaWdodHMgPT09IDEpIHtcclxuICAgICAgdGV4dCA9ICdPbmUgbmlnaHQ6ICcgKyB0b05pZ2h0LmZvcm1hdChjYWxlbmRhci5mb3JtYXQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGV4dCA9IGA8Yj4ke25pZ2h0c308L2I+IG5pZ2h0c2AgKyAnIG5pZ2h0cywgZnJvbSA8Yj4nICsgY2FsZW5kYXIuc3RhcnREYXkuZm9ybWF0KGNhbGVuZGFyLmZvcm1hdCkgKyAnPC9iPiB0byA8Yj4nICsgdG9OaWdodC5mb3JtYXQoY2FsZW5kYXIuZm9ybWF0KSArICc8L2I+JztcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdGV4dDtcclxuICB9O1xyXG5cclxuICBjb25zdCBvbkFwcGx5Q2FsZW5kYXIgPSBmdW5jdGlvbigpIHtcclxuICAgIGxldCBjYWxlbmRhciA9IHRoaXM7XHJcblxyXG4gICAgY2FsZW5kYXIucm9vbV9uYW1lID0gdGhpcy4kZWwuY2xvc2VzdCgnLmFia25nY2FsLWNvbnRhaW5lcicpLmZpbmQoJ2gyJykudGV4dCgpO1xyXG4gICAgY2FsZW5kYXIuZGF0YV9pZCAgID0gdGhpcy4kZWwuY2xvc2VzdCgnW2RhdGEtcm9vbV0nKS5kYXRhKCdyb29tJyk7XHJcbiAgICBjYWxlbmRhci5jb21tZW50cyAgPSBzaG93Q29tbWVudHMoY2FsZW5kYXIpO1xyXG5cclxuICAgIGNvbnN0IGZvcm1UZW1wbGF0ZSA9IHdwLnRlbXBsYXRlKCdhdmFpbGFiaWxpdHktY2FsZW5kYXItZm9ybScpO1xyXG4gICAgJGRpYWxvZy5maW5kKCcuYXdlYm9va2luZy1kaWFsb2ctY29udGVudHMnKS5odG1sKGZvcm1UZW1wbGF0ZShjYWxlbmRhcikpO1xyXG5cclxuICAgICRkaWFsb2cuZmluZCgnZm9ybScpLmRhdGEoJ2NhbGVuZGFyJywgY2FsZW5kYXIpO1xyXG4gICAgJGRpYWxvZy5kaWFsb2coJ29wZW4nKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBhamF4R2V0Q2FsZW5kYXIgPSBmdW5jdGlvbihjYWxlbmRhcikge1xyXG4gICAgY29uc3QgJGNvbnRhaW5lciA9IGNhbGVuZGFyLiRlbC5wYXJlbnRzKCcuYWJrbmdjYWwtY29udGFpbmVyJyk7XHJcbiAgICAkY29udGFpbmVyLmZpbmQoJy5hYmtuZ2NhbC1hamF4LWxvYWRpbmcnKS5zaG93KCk7XHJcblxyXG4gICAgd3AuYWpheC5wb3N0KCAnZ2V0X2F3ZWJvb2tpbmdfeWVhcmx5X2NhbGVuZGFyJywge1xyXG4gICAgICB5ZWFyOiAkY29udGFpbmVyLmZpbmQoJy5hYmtuZ2NhbCBzZWxlY3QnKS52YWwoKSxcclxuICAgICAgcm9vbTogJGNvbnRhaW5lci5kYXRhKCdyb29tJyksXHJcbiAgICB9KVxyXG4gICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICBjYWxlbmRhci5kZXN0cm95KCk7XHJcbiAgICAgIGNhbGVuZGFyLiRlbC5maW5kKCdzZWxlY3QnKS5vZmYoKTtcclxuXHJcbiAgICAgICRjb250YWluZXIuaHRtbCgkKGRhdGEuaHRtbCkuaHRtbCgpKTtcclxuICAgICAgY2FsZW5kYXIuJGVsID0gJGNvbnRhaW5lci5maW5kKCcuYWJrbmdjYWwuYWJrbmdjYWwtLXllYXJseScpO1xyXG5cclxuICAgICAgY2FsZW5kYXIuaW5pdGlhbGl6ZSgpO1xyXG4gICAgICBjYWxlbmRhci5vbignYXBwbHknLCBvbkFwcGx5Q2FsZW5kYXIpO1xyXG4gICAgICBjYWxlbmRhci4kZWwuZmluZCgnc2VsZWN0Jykub24oJ2NoYW5nZScsIGFqYXhHZXRDYWxlbmRhci5iaW5kKG51bGwsIGNhbGVuZGFyKSk7XHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICAkKCcuYWJrbmdjYWwuYWJrbmdjYWwtLXllYXJseScsIGRvY3VtZW50KS5lYWNoKGZ1bmN0aW9uKGluZGV4LCBlbCkge1xyXG4gICAgbGV0IGNhbGVuZGFyID0gbmV3IHdpbmRvdy5Bd2VCb29raW5nWWVhcmx5Q2FsZW5kYXIoZWwpO1xyXG4gICAgJChlbCkuZGF0YSgnYXZhaWxhYmlsaXR5LWNhbGVuZGFyJywgY2FsZW5kYXIpO1xyXG5cclxuICAgIGNhbGVuZGFyLm9uKCdhcHBseScsIG9uQXBwbHlDYWxlbmRhcik7XHJcbiAgICBjYWxlbmRhci4kZWwuZmluZCgnc2VsZWN0Jykub24oJ2NoYW5nZScsIGFqYXhHZXRDYWxlbmRhci5iaW5kKG51bGwsIGNhbGVuZGFyKSk7XHJcbiAgfSk7XHJcblxyXG4gICRkaWFsb2cuZmluZCgnZm9ybScpLm9uKCdzdWJtaXQnLCBmdW5jdGlvbihlKSB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgY29uc3QgJGVsID0gJCh0aGlzKTtcclxuICAgIGNvbnN0IGNhbGVuZGFyID0gJGVsLmRhdGEoJ2NhbGVuZGFyJyk7XHJcblxyXG4gICAgJGVsLmFkZENsYXNzKCdhamF4LWxvYWRpbmcnKTtcclxuICAgIEF3ZUJvb2tpbmcuYWpheFN1Ym1pdCh0aGlzLCAnc2V0X2F3ZWJvb2tpbmdfYXZhaWxhYmlsaXR5JylcclxuICAgICAgLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuICAgICAgICAkZWwucmVtb3ZlQ2xhc3MoJ2FqYXgtbG9hZGluZycpO1xyXG4gICAgICB9KVxyXG4gICAgICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgYWpheEdldENhbGVuZGFyKGNhbGVuZGFyKTtcclxuICAgICAgICAkZGlhbG9nLmRpYWxvZygnY2xvc2UnKTtcclxuICAgICAgfSlcclxuICAgICAgLmZhaWwoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIGlmIChlLmVycm9yICYmIHR5cGVvZiBlLmVycm9yID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgYWxlcnQoZS5lcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgKG5ldyBBd2VCb29raW5nLlJhbmdlRGF0ZXBpY2tlcihcclxuICAgICdpbnB1dFtuYW1lPVwiZGF0ZXBpY2tlci1zdGFydFwiXScsXHJcbiAgICAnaW5wdXRbbmFtZT1cImRhdGVwaWNrZXItZW5kXCJdJ1xyXG4gICkpLmluaXQoKTtcclxuXHJcbiAgKG5ldyBBd2VCb29raW5nLlRvZ2dsZUNoZWNrYm94ZXMoXHJcbiAgICAndGFibGUuYXdlYm9va2luZ19wYWdlX21hbmFnZXItYXdlYm9va2luZydcclxuICApKTtcclxufSk7XHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL2Fzc2V0cy9qc3NyYy9hZG1pbi9tYW5hZ2VyLWF2YWlsYWJpbGl0eS5qcyJdLCJzb3VyY2VSb290IjoiIn0=